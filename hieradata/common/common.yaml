---
classes:
  - profile::base::common
classes_bootstrap:
  - profile::base::common

profile::base::common::manage_augeasproviders: true
profile::base::common::manage_epel:            true
profile::base::common::manage_accounts:        true
profile::base::common::manage_logging:         false
profile::base::common::manage_monitoring:      false
profile::base::common::manage_ssh:             true
profile::base::common::manage_ntp:             true
profile::base::common::manage_sudo:            true
profile::base::common::manage_authconfig:      false
profile::base::common::manage_firewall:        true
profile::base::common::manage_timezones:       true

account::accounts:
  iaas:
    ssh_key_type: rsa
    ssh_key: AAAAB3NzaC1yc2EAAAADAQABAAABAQC+OF1sQvpZdYhxVJgrd+1P84/AegFJHY5W0SLIO8dF4K6CP08bJNwg+5eD8kxebmoXTJlfIRC1onJfjDPl94x9F3x18zib3kiSIPnkN7BsCZIxTcN1czHRUEtyOPG9JlKCagaXwHkBIzYIngF9hwBix9ZetuYieiZU/rhnk7x/zNxmjqPBf26rEI1qk4S6xYoAJjx0YFUbLYYiqc7YxGypo0ag99nKaZpy2p5mMyYGn4nGmlCzSG+aANokvlz8gwVzThaIPB8s0YYdXf1w/1OdFcUuW8Wm3AonFZcVhGfJy3yaAZDvbpWI1JVbJ9hMOo5Tml6nx8FM8MU6mAoamgRT
    groups:
      - wheel
      - users
  vagrant:
    ensure: absent

sudo::configs:
  wheel:
    priority: 15
    content: '%wheel ALL=(ALL) NOPASSWD:ALL'

ntp::servers:
  - 0.pool.ntp.org
  - 1.pool.ntp.org
  - 2.pool.ntp.org
  - 3.pool.ntp.org

ssh::server::storeconfigs_enabled: false
ssh::server::options:
  PermitRootLogin: 'no'
  PasswordAuthentication: 'no'

timezone::timezone: "Europe/Oslo"

puppet::puppetmaster: "puppet.%{domain}"
puppet::additional_settings:
  'basemodulepath'   : '/etc/puppet/modules:/opt/himlar/modules'
  'certname'         : "%{::verified_certname}"
  'trusted_node_data': true
  'disable_warnings' : 'deprecations'

#
# Ceph parameters
#
ceph::profile::params::manage_repo:                 false
ceph::profile::params::release:                     'firefly'
######## Ceph.conf - Cluster and location spesific data
ceph::profile::params::fsid:                        '4b5c8c0a-ff60-454b-a1b4-9747aa737d19'
ceph::profile::params::authentication_type:         'cephx'
#ceph::profile::params::mon_initial_members:         'cephmon-1, cephmon-2'
#ceph::profile::params::mon_host:                    '10.0.0.10:6789, 10.0.0.11:6789'
ceph::profile::params::osd_pool_default_pg_num:     '4096'
ceph::profile::params::osd_pool_default_pgp_num:    '4096'
ceph::profile::params::osd_pool_default_size:       '3'
ceph::profile::params::osd_pool_default_min_size:   '1'
#ceph::profile::params::cluster_network:             '10.0.0.0/24'
#ceph::profile::params::public_network:              '10.0.0.0/24'
######## Keys - Cluster and location spesific data
ceph::profile::params::mon_key:                     'AQATGHJTUCBqIBAA7M2yafV1xctn1pgr3GcKPg=='
## as an alternative to specifying the mon key you can provide an exising keyring
##ceph::profile::params::mon_keyring: '/etc/ceph/ceph.mon.keyring'
ceph::profile::params::client_keys:
  'client.admin':
    secret: 'AQBMGHJTkC8HKhAAJ7NH255wYypgm1oVuV41MA=='
    mode: '0600'
    cap_mon: 'allow *'
    cap_osd: 'allow *'
    cap_mds: 'allow *'
  'client.bootstrap-osd':
    secret: 'AQARG3JTsDDEHhAAVinHPiqvJkUi5Mww/URupw=='
    keyring_path: '/var/lib/ceph/bootstrap-osd/ceph.keyring'
    cap_mon: 'allow profile bootstrap-osd'
  'client.bootstrap-mds':
    secret: 'AQCztJdSyNb0NBAASA2yPZPuwXeIQnDJ9O8gVw=='
    keyring_path: '/var/lib/ceph/bootstrap-mds/ceph.keyring'
    cap_mon: 'allow profile bootstrap-mds'
  'client.volumes':
    secret: 'AQA4MPZTOGU0ARAAXH9a0fXxVq0X25n2yPREDw=='
    mode: '0600'
    user: 'cinder'
    group: 'cinder'
    cap_mon: 'allow r'
    cap_osd: 'allow class-read object_prefix rbd_children, allow rwx pool=volumes'
#ceph::profile::params::osds:
#  '/var/osd1':
#    journal: '/var/osd1-journal'

#
# Location metadata
#
location_description: unset
location_environment: unset
location_tag: unset

valid_location_tags:
  - bgo
  - osl
  - trd
  - vagrant
valid_location_environments:
  - prod
  - dev

#
# Network configuration data
#
networks:
  bgo:
    domain:
      mgmt: mgmt.iaas.intern
      oob: oob.iaas.intern
    subnet:
      mgmt: 172.16.32.1/21
      oob: 172.16.24.1/21
    dhcp:
      mgmt:
        ensure: absent
      oob:
        ensure: present
        interface: eth2
        start_offset: 100
        end_offset: 199
        lease: 43200
    nat:
      mgmt:
        ensure: present
      oob:
        ensure: present
  osl:
    domain:
      mgmt: iaas.uio.no
      oob: iaas.uio.no
    subnet:
      mgmt: 129.240.224.97/27
      oob: 129.240.224.65/27
    dhcp:
      mgmt:
        ensure: absent
      oob:
        ensure: absent
    nat:
      mgmt:
        ensure: absent
      oob:
        ensure: absent
  trd:
    domain:
      mgmt: mgmt.iaas.ntnu.no
      oob: oob.iaas.ntnu.no
    subnet:
      mgmt: 10.171.91.1/24
      oob: 10.171.86.1/24
    dhcp:
      mgmt:
        ensure: absent
      oob:
        ensure: present
        interface: eth2
        start_offset: 100
        end_offset: 199
        lease: 43200
    nat:
      mgmt:
        ensure: present
      oob:
        ensure: present
  vagrant:
    domain:
      mgmt: himlar.local
    subnet:
      mgmt: 10.0.3.1/24
      oob: 10.0.4.1/24
    dhcp:
      mgmt:
        ensure: absent
      oob:
        ensure: present
        interface: eth1
        start_offset: 100
        end_offset: 199
        lease: 43200
    nat:
      mgmt:
        ensure: present
      oob:
        ensure: present

